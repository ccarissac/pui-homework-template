<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv = "X-UA-Compatible" content="IE=edge"/>
    <meta name = "viewport" content="width=device-width, iniial-scale=1.0" />
    <title>Memory Box</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap');
      </style>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.158.0/three.module.js" integrity="sha512-CVIscA/hc9q95K8mJ/3YjeKYFuDIYEpZH2V9XW5tBe32tFmLwHYwWJ/0f/H30rLC+08ZEreeigx+zlxdBJT2Dw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->
</head>

<body>
  <script type="module">
    import * as THREE from "../module/three.module.js";
    import { OrbitControls } from "https://cdnjs.cloudflare.com/ajax/libs/three.js/0.158.0/three.module.js";
    
    // image credits
    //flare image: https://opengameart.org/content/flare-effect-blender
    //smoke image: https://opengameart.org/content/flare-effect-blender

    let clock = new THREE.Clock(); //keep track of time
    let delta = 0; //will store getDetla value (amt of time passed since clock updated)

    //CAMERA
    const camera = new THREE.PerspectiveCamera (
        75, window.innerWidth / window.innerHeight, 
        1, 
        1500
    );
    camera.position.z = 1000;

    //SCENE
    const scene = new THREE.Scene();
    scene.fog = new THREE.Fog (0xc0f0ff, 0.0015); //color, near

    //RENDERER
    const renderer = new THREE.WebGLRenderer ( {antialias: true} );
    renderer.setPixelRatio (window.devicePixelRatio );
    renderer.setSize( window.innerWidth, window.innerHeight );
    document.body.appendChild (renderer.domElement );

    //LIGHT - no shadows

    const light = new THREE.HemisphereLight ( 0xd6e6ff, 0xa38c08, 1);
    scene.add( light ); 

    //ORBIT CONTROLS
    const controls = new OrbitControls(camera, renderer.domElement);

    //SMOKE TEXTURE
    const smokeTexture = new THREE.TextureLoader().load("../materials/smoke_02.png");
    smokeTexture.encoding = THREE.sRGBEncoding;
    const smokeGeometry = new THREE.PlaneGeometry(300,300); //set size of plane
    
    //LambertMaterial for non-shiny surfaces
    const smokeMaterial = new THREE.MeshLambertMaterial ({
        map: smokeTexture, 
        emissive: 0x222222, 
        opacity: 0.15, 
        transparent: true
    });

    let smokeParticles = []; //empty to put smoke textures into

    for (let i=0; i<98; i++) {
        let smokeElement = new THREE.Mesh (smokeGeometry, smokeMaterial);
        smokeElement.scale.set(2, 2, 2); // set scale to x, y, z, to double

        //position smoke textures at random x, y, z positions
        smokeElement.position.set(Math.random() * 1000-500, Math.random()*1000 - 500, Math.random() * 1000-100);

        smokeElement.rotation.z = Math.random() *360;

        scene.add(smokeElement);
        smokeParticles.push(smokeElement);
    }

    window.addEventListener ("resize", onWindowResize);

    animate();

    function animate() {

        requestAnimationFrame( animate );
        delta = clock.getDelta();

        for (let i=0; i<smokeParticles.length; i++) { 
            smokeParticles[i].rotation.z +=(delta * 0.12);
        }
        renderer.render (scene, camera);
    }

    function onWindowResize() {
        camera.aspect=window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize ( window.innerWidth, window.innerHeight );
    }


</script>

</body>
</html>